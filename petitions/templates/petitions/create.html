{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container py-4">
  <div class="row mb-4">
    <div class="col-12">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="{% url 'petitions.list' %}">Petitions</a></li>
          <li class="breadcrumb-item active" aria-current="page">Create Petition</li>
        </ol>
      </nav>
    </div>
  </div>

  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="card">
        <div class="card-body">
          <h1 class="h2 fw-bold mb-4">Create New Petition</h1>
          <p class="text-muted mb-4">
            Create a petition to request that a specific movie be added to our catalog. 
            Other users will be able to vote on whether they want to see this movie added.
          </p>

          <form method="post">
            {% csrf_token %}
            
            <div class="mb-3">
              <label for="title" class="form-label">Petition Title *</label>
              <input type="text" class="form-control" id="title" name="title" 
                     placeholder="e.g., Add The Dark Knight to our catalog" required>
              <div class="form-text">A clear, descriptive title for your petition (max 200 characters)</div>
            </div>

            <div class="mb-3">
              <label for="movie_title" class="form-label">Movie Title *</label>
              <input type="text" class="form-control" id="movie_title" name="movie_title" 
                     placeholder="e.g., The Dark Knight" required>
              <div class="form-text">The exact title of the movie you want added (max 200 characters)</div>
            </div>

            <div class="mb-4">
              <label for="description" class="form-label">Description *</label>
              <textarea class="form-control" id="description" name="description" rows="6" 
                        placeholder="Explain why this movie should be added to our catalog. What makes it special? Why would other users want to see it?" required></textarea>
              <div class="form-text">Provide a compelling description to convince others to vote for this movie (max 1000 characters)</div>
            </div>

            <div class="d-flex gap-3">
              <button type="submit" class="btn btn-primary">
                Create Petition
              </button>
              <a href="{% url 'petitions.list' %}" class="btn btn-outline-secondary">
                Cancel
              </a>
            </div>
          </form>
        </div>
      </div>

      <div class="card mt-4">
        <div class="card-body">
          <h5 class="card-title">Tips for a Great Petition</h5>
          <ul class="mb-0">
            <li><strong>Be specific:</strong> Include the exact movie title and year if applicable</li>
            <li><strong>Explain why:</strong> Tell users why this movie is worth adding to our catalog</li>
            <li><strong>Be respectful:</strong> Keep your description professional and appropriate</li>
            <li><strong>Check first:</strong> Make sure the movie isn't already in our catalog</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const titleInput = document.getElementById('title');
  const movieInput = document.getElementById('movie_title');
  const descriptionInput = document.getElementById('description');
  
  // Character counters
  function addCharacterCounter(input, maxLength) {
    const counter = document.createElement('small');
    counter.className = 'text-muted character-counter';
    counter.style.display = 'block';
    counter.style.marginTop = '0.25rem';
    
    input.parentNode.appendChild(counter);
    
    function updateCounter() {
      const remaining = maxLength - input.value.length;
      counter.textContent = `${remaining} characters remaining`;
      counter.className = remaining < 50 ? 'text-danger character-counter' : 'text-muted character-counter';
    }
    
    input.addEventListener('input', updateCounter);
    updateCounter();
  }
  
  addCharacterCounter(titleInput, 200);
  addCharacterCounter(movieInput, 200);
  addCharacterCounter(descriptionInput, 1000);
});
</script>
{% endblock %}
